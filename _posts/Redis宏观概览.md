---
title: Redis宏观概览
date: 2017-06-09 21:07:22
tags:
- Redis
- Linux
categories:
- Redis
---

记录下Redis的简述

<!--more-->

[<font color=#0099ff>Redis官网</font>](https://redis.io)，redis3.0版本才支持集群服务。

## NOSQL简介

NOSQL，泛指非关系型数据库，数据一般存储在内存中效率很高，分为4大类：

* 键值存储数据库：使用哈希表，表中包含一个特定的键（String、hash、list、set、zset）和一个指针指向特定的数据，如Redis

* 列存储数据库：用于应对分布式存储的海量数据，键仍存在，但可指向多个列，如HBase

* 文档型数据库：半结构化的文档以特定的格式存储，如JSON；可看作是键值数据库的升级，允许之间嵌套键值，且比键值数据库的查询效率更高，如MongoDb

* 图形数据库：用到不多，略 

## redis持久化

由于redis中数据是基于内存的，如果服务器异常掉电，下次恢复后数据就没了，所以为了高可靠性，可以在redis的配置文件中选中RDB或者AOF，但是RDB不太适用实时的系统，一般都会选择实时的AOF作为数据持久化的选择 

* RDB : 周期性的把内存里的更新数据同步写入到指定服务器的硬盘上

* AOF ：(相当于Oracle的undo) 会实时的将DML操作记录一个持久化日志*.aof文件里，假如说服务器掉电后恢复的时候会直接从日志文件里读取之前的操作.

## 集群策略

* 主从形式：1 主（写），n 从（读），弊端就是主服务器挂了整个集群就挂了

* 2.x哨兵形式：增加一台哨兵节点去监控其他服务器，当主节点挂了的时候，哨兵节点启动在N个从节点中进行投票选举将某台性能较好的服务器升级成主节点，下次挂了的主节点恢复后会作为从节点加入进来

* 3.0后集群形式：2.x哨兵形式的弊端就是每台主从节点上的数据都是一样的相当于备份，前两种都无法实现数据的分布式，3.0后实现了数据的分布水平扩展以及单节点的高可用

## 高可靠优化

由于要考虑数据的高可靠性，在高并发的时候还是需要记录aof日志，虽然读的性能很高但是写性能很低

* 2.x的时候可以调虚拟机的一些参数

* 3.0集群后参数就不可调了，一方面可以多加几台主节点分担高并发写的压力，另一方面可以使用redis+ssdb组合在高并发写的性能很快

## 数据一致性

* 缓存中一般不会涉及到很重要的数据，所以不是太要求缓存数据一定要与关系型数据库中数据高度的一致

* 如果真的需要高度的一致，可以的程序中设计保存关系型数据库中的同时同步到缓存中，当然两步需要做事物的控制.

