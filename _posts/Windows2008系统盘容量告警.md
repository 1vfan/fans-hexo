---
title: 生产环境Windows2008系统盘容量告警
date: 
tags:
- windows
---

Windows2008 C盘容量剩余超出阀值.

<!--more-->

## what

生产上Window2008机器的C盘空间被占满，查看系统的隐藏文件，发现``pagefile.sys``文件占用了C盘大部分空间。

## why

如果计算机的物理内存不足以支撑当前系统程序或进程，则 Windows 会使用硬盘空间来模拟系统内存，这叫做虚拟内存(通常称为页面文件)；当设置了虚拟内存托管磁盘下就会产生pagefile.sys文件，通常默认为物理内存的1.5倍存储在C盘下。

虚拟内存的设定对于计算机的性能在一定程度上是有好处的，但是当C盘剩余空间与物理内存大小接近时，在系统运行大内存程序时，pagefile.sys文件就会增大到占满整个C盘，导致系统卡死。

## how

将pagefile.sys文件转移到其他空间较大的数据库而非重要的系统盘，同时自定义限制pagefile.sys文件的大小。

1. 右键计算机 -> 属性 -> 高级系统设置 -> 高级 -> 性能选项的设置 -> 高级 -> 虚拟内存 -> 更改

2. 取消"自动管理所有驱动器的分页文件大小" -> 选择C盘 -> 选择无分页文件 -> 设置

3. 选择数据盘D盘 -> 自定义大小 -> 初始大小配置如:8192，最大值配置如:12288 -> 设置 -> 确定 -> 重启机器

重启后发现pagefile.sys文件转移到了D盘，同时原先告警的C盘空间得到大幅度的释放。


